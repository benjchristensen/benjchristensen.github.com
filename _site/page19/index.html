<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Ben Christensen &middot; 
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body class=" layout-reverse">

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
          Ben Christensen
      </h1>
      <p class="lead">Software Engineer at Netflix, previously Apple</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/">Home</a>

      

      
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/about/">About</a>
          
        
      
        
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/toc/">Posts</a>
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      

      <a class="sidebar-nav-item" href="http://twitter.com/benjchristensen">Twitter</a>
      <a class="sidebar-nav-item" href="http://github.com/benjchristensen">Github</a>
      <a class="sidebar-nav-item" href="http://github.com/ReactiveX/RxJava">&bull; RxJava</a>
      <a class="sidebar-nav-item" href="http://github.com/Netflix/Hystrix">&bull; Hystrix</a>
      <a class="sidebar-nav-item" href="http://linkedin.com/in/benjchristensen">LinkedIn</a>
    </nav>


    <p>&copy; 2015. All rights reserved.</p>
  </div>
</div>


    <div class="content container">
      <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/code/performance/2007/02/16/32-bit-versus-64-bit-jdk-memory-usage/">
        32-bit versus 64-bit JDK Memory Usage
      </a>
    </h1>

    <span class="post-date">16 Feb 2007</span>

    <p>Summary of analysis performed September 2006.</p>

<p>Testing Strategy</p>

<p>To ensure the tests performed were reliable and behaved the same every time with as few variables as possible, a simple program (a single java class) was written which loops indefinitely, adding objects to a collection until it runs out of memory.</p>

<p>This test was performed with both Integer and String objects, and then executed with 3 different JVMs with varying heap settings.</p>

<p>The results and details of these tests are documented in later chapters.</p>

<p>JVMs tested:
- JDK 1.4.2 32-bit
- JDK 1.5 32-bit
- JDK 1.5 64-bit</p>

<p>Operating Systems Tested
- Solaris 10 on Opterons
- Suse Linux 10 on Opterons</p>

<p>The tests are far from exhaustive, but were enough to derive numbers and patterns whereby the JVMs can be sized accurately and recommendations made.</p>

<p>Findings</p>

<ul>
<li>Tests performed consistently on both Linux and Solaris (except for maximum heap sizes)</li>
<li>JDK 5 64-bit takes between 40% - 50% more memory on average than either 32-bit JVM</li>
<li><p>JDK 1.4 32-bit is slightly more memory efficient than JDK 5 32-bit
o It is slightly better than JDK 5 32-bit in Integer tests
o It is exactly the same as JDK 5 32-bit in String tests</p></li>
<li><p>Solaris 10 can run a 32-bit JVM up to 3.5GB</p></li>
<li><p>Suse Linux can run a 32-bit JVM up to 2GB</p></li>
<li><p>A 64-bit JVM was successfully run at 20GB on Suse Linux</p></li>
<li><p>A 2GB 32-bit JVM is approximately equivalent to a 3GB 64-bit JVM in number of objects stored
o ie. On Suse Linux, if more than 2GB heap is needed, then one must jump to a 3GB 64-bit JVM to achieve the same amount of storage
o ie. On Solaris, if more than 3.5GB heap is needed, then one must jump to a 5GB 64-bit JVM to achieve the same amount of storage</p></li>
</ul>

<p>Recommendations</p>

<p>Based upon these findings, it is recommended that JDK 5 32-bit be used as the default JVM, and 64-bit used if more memory is needed than what can be allocated to a 32-bit JVM with the understanding of the ratio one must increase to account for the change to a 64-bit data model.</p>

<p>The reasons for choosing JDK 5 over JDK 1.4 are:</p>

<ul>
<li><p>JDK 5 is the current recommended production JVM from Sun Microsystems
o It has been out for more than 2 years and is at its 8th maintenance release (JDK 1.5_08)</p></li>
<li><p>General performance improvements from JDK 1.4 to JDK 5
o http://java.sun.com/j2se/1.5.0/docs/guide/performance/speed.html
o http://java.sun.com/j2se/1.5.0/docs/guide/vm/index.html</p></li>
<li><p>Improved garbage collection algorithms, particularly for multi-processor machines
o http://java.sun.com/docs/hotspot/gc5.0/gc<em>tuning</em>5.html</p></li>
<li><p>64-bit JVM available on AMD Opterons when larger heap sizes required (not available for JDK 1.4)
o http://java.sun.com/j2se/1.5.0/docs/relnotes/features.html#platform_proc64</p></li>
</ul>

<p>Summary</p>

<p>The tests performed confirmed that the 64-bit JVM does indeed use more memory than the 32-bit JVMs, but that it behaves consistently and can be calculated, and therefore planned for.
It is recommended to use JDK 5 32-bit as the default JVM, and the 64-bit variant when larger heap sizes are required.</p>

<p>Java Source File: <a href="http://benjchristensen.files.wordpress.com/2007/04/memorytestjava.doc">MemoryTest.java</a></p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/code/2007/01/08/keyword-search-spelling-suggestions/">
        Keyword Search - Spelling Suggestions
      </a>
    </h1>

    <span class="post-date">08 Jan 2007</span>

    <p>Here are some valuable links related to how to provide spelling suggestions in keyword search.</p>

<ul>
<li><p><a href="http://today.java.net/pub/a/today/2005/08/09/didyoumean.html">Lucene: Did you mean?</a></p></li>
<li><p><a href="http://aspell.net/">GNU Aspell</a></p></li>
<li><p><a href="http://jazzy.sourceforge.net/">Jazzy</a></p>

<ul>
<li><a href="http://www-128.ibm.com/developerworks/java/library/j-jazzy/">Can&#39;t beat Jazzy</a></li>
</ul></li>
<li><p><a href="http://jaspell.sourceforge.net/">JaSpell</a></p></li>
<li><p><a href="http://wordlist.sourceforge.net/">Wordlist</a></p></li>
<li><p><a href="http://acl.ldc.upenn.edu/acl2004/emnlp/pdf/Cucerzan.pdf">Whitepaper</a> on exploiting past search history</p></li>
<li><p><a href="http://en.wikipedia.org/wiki/Spellcheck">SpellCheck on Wikipedia</a></p></li>
</ul>

<p>Here is a commercial option in Java if Jazzy isn&#39;t good enough ...</p>

<ul>
<li><a href="http://www.thesolutioncafe.com/java-spell-checker.html">JSpell</a></li>
</ul>

<p>And some interesting links on N-Grams that Lucene and Google use:</p>

<ul>
<li><p><a href="http://googleresearch.blogspot.com/2006/08/all-our-n-gram-are-belong-to-you.html">Google Releases N-Grams</a></p></li>
<li><p><a href="http://en.wikipedia.org/wiki/N-gram">Wikipedia - N-Gram
</a></p></li>
</ul>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2007/01/05/dual-big-screens-for-development/">
        Dual Big Screens for Development
      </a>
    </h1>

    <span class="post-date">05 Jan 2007</span>

    <p>Martin Fowler comments on something I agree with ... big screens increase productivity and make development easier.</p>

<p><a href="http://martinfowler.com/bliki/BigScreen.html">http://martinfowler.com/bliki/BigScreen.html</a></p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/performance/2007/01/04/sun-x4200-vs-sun-t1000-inquireserver-inquireweb/">
        Sun x4200 vs Sun T1000 => inQuireServer & inQuireWeb
      </a>
    </h1>

    <span class="post-date">04 Jan 2007</span>

    <p>inQuireServer Tests</p>

<p>A test was done using JMeter using an inQuire Client accessing an inQuire server running on the same local machine.</p>

<p>This is done over JINI using JERI.</p>

<p>Configuration was:
- Catalog: AIDC
- Server Heap: 1GB
- Client Heap: 512MB
- Server JVM: 1.5
- Client JVM: 1.5
- inQuire Build: 4th Jan 07
- Client side caching turned on: Yes</p>

<p>The following image shows the results (times in ms):</p>

<p><a href="http://bp0.blogger.com/_CvV7agFF3Zc/RaKlfxUhp6I/AAAAAAAAACQ/VBstnK8RqIw/s1600-h/t1000-x4200-inquire-server.png"><img src="http://bp0.blogger.com/_CvV7agFF3Zc/RaKlfxUhp6I/AAAAAAAAACQ/VBstnK8RqIw/s400/t1000-x4200-inquire-server.png" alt=""></a>
First Test - DC, Keyword and Complex</p>

<p>The T1000 performs very poorly when the thread count is low.</p>

<p>Interestingly however, even though it&#39;s gap with the X4200 does reduce, it never gets better, or even close to as good as the X4200.</p>

<p>And surprisingly, it crashes and burns when we try and hit 5000 threads -- a level that is ridiculously slow on the X4200, but at least it runs.</p>

<p>Second Test - DC Only</p>

<p>The second round of tests showed an interesting result -- that the T1000 performs MUCH better when IO intensive tasks are avoided -- such as keyword search which hits the filesystem.</p>

<p>It&#39;s still not as good as the X4200 at low thread counts, but much more reasonable -- and does end up scaling better than the X4200.</p>

<p>However, in my opinion, the scale it shows is not nearly superior enough to the X4200 to sacrifice the performance at low or single thread counts, and especially not the lack of Filesystem IO.</p>

<p>inQuireWeb Tests</p>

<p>The next round of testing as against Tomcat running inQuireWeb backed by inQuireServer instances as already tested above.</p>

<p>Client side caching was enabled in inQuireWeb so as to reduce hits to the servers and test Tomcat specifically.</p>

<p>The following image shows how if Tomcat and the inQuireServer were on the same machine, the X4200 was superior, while if Tomcat was on the T1000, and inQuireServer on the X4200, then the T1000 came out on top when it started to scale.</p>

<p><a href="http://bp0.blogger.com/_CvV7agFF3Zc/RaKl0xUhp7I/AAAAAAAAACY/C4k0dvoE_Og/s1600-h/t1000-x4200-inquireweb.png"><img src="http://bp0.blogger.com/_CvV7agFF3Zc/RaKl0xUhp7I/AAAAAAAAACY/C4k0dvoE_Og/s400/t1000-x4200-inquireweb.png" alt=""></a>So the conclusion from these tests are that the T1000 does indeed have certain niches where it can perform and scale better than the Opteron based X4200 -- but they are hard to find, and if you don&#39;t fit that exact niche, a huge performance hit will be incurred.</p>

<p>At this point, databases and the inQuireServer are out of the questions for the T1000 -- relegating it to a glorifed webserver ... able to host Apache and/or Tomat, as long as the heavy lifting of searches and IO are done elsewhere -- such as on the X4200.</p>

<p>Ben</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/performance/2007/01/01/sun-x4200-vs-sun-t1000-load-server/">
        Sun x4200 vs Sun T1000 => Load Server
      </a>
    </h1>

    <span class="post-date">01 Jan 2007</span>

    <p>Testing the Sun T1000 and Sun X4200 continues ...</p>

<p>... with the databases loaded, I&#39;m now starting the inQuire Server with various types of configuration involving indexing in MEMORY, FILESYSTEM or DATABASE.</p>

<p>I understand that these processes are still primarily single-threaded ... but I&#39;m so far not very impressed by the T1000.</p>

<p>If it takes 7+ times longer to initialize a process before I can even get to a point where parallel processing can occur, it&#39;s questionable if it&#39;s worth it.</p>

<p>And ... the inQuire Keyword FILESYSTEM implementation is really slow and needs to be replaced.</p>

<p><a href="http://bp1.blogger.com/_CvV7agFF3Zc/RZoE59x2RNI/AAAAAAAAABs/a_b6ioJyZX4/s1600-h/t1000vsx4200-load.png">
</a><a href="http://bp1.blogger.com/_CvV7agFF3Zc/RaKf4BUhp5I/AAAAAAAAACE/RvKnopcAJo0/s1600-h/t1000-x4200-load.png"><img src="http://bp1.blogger.com/_CvV7agFF3Zc/RaKf4BUhp5I/AAAAAAAAACE/RvKnopcAJo0/s400/t1000-x4200-load.png" alt=""></a></p>

  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page20">Older</a>
  
  
    
      <a class="pagination-item newer" href="/page18">Newer</a>
    
  
</div>
    </div>

  </body>
</html>
